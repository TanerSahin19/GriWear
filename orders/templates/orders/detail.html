{% extends "base.html" %} {% block title %}Sipari≈ü Detayƒ±{% endblock %} {% block
content %}
<div class="container py-4">
  <!-- üßæ SAYFA BA≈ûLIƒûI
       Kullanƒ±cƒ± hangi sipari≈üte olduƒüunu net g√∂rs√ºn -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold mb-0">Sipari≈ü #{{ order.id }}</h2>

    <!-- üîô GERƒ∞ D√ñN
         Kullanƒ±cƒ± sipari≈ü listesine kolayca d√∂nebilsin -->
    <a href="{% url 'orders:my_orders' %}" class="btn btn-sm btn-outline-dark">
      Sipari≈ülerime D√∂n
    </a>
  </div>
  {% if order.status == "pending" %}
  <form method="post" action="{% url 'orders:cancel_order' order.id %}">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger">Sipari≈üi ƒ∞ptal Et</button>
  </form>
  {% endif %}

  <div class="row g-4">
    <!-- üì¶ SOL TARAF: Sƒ∞PARƒ∞≈ûTEKƒ∞ √úR√úNLER -->
    <div class="col-lg-7">
      <div class="card">
        <div class="card-body">
          <!-- Ba≈ülƒ±k -->
          <h5 class="mb-3">√úr√ºnler</h5>

          <!-- üîÅ Bu sipari≈üe ait t√ºm √ºr√ºnleri (OrderItem) dola≈ü -->
          <h5 class="mb-3">√úr√ºnler</h5>

          {% for item in order.items.all %}
          <div class="d-flex justify-content-between align-items-center mb-3">
            <div>
              <div class="fw-semibold">{{ item.name }}</div>
              <div class="text-muted small">Adet: {{ item.quantity }}</div>
            </div>

            <div class="text-end">
              <div class="fw-semibold">
                {{ item.unit_price|floatformat:2 }} ‚Ç∫
              </div>
              <div class="small text-muted">
                Toplam: {{ item.line_total|floatformat:2 }} ‚Ç∫
              </div>
            </div>
          </div>
          {% empty %}
          <p>Bu sipari≈üte √ºr√ºn bulunamadƒ±.</p>
          {% endfor %}

          <!-- Eƒüer sipari≈üte √ºr√ºn yoksa (normalde olmaz ama g√ºvenlik) -->
          <p>Bu sipari≈üte √ºr√ºn bulunamadƒ±.</p>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- üßæ SAƒû TARAF: Sƒ∞PARƒ∞≈û √ñZETƒ∞ -->
    <div class="col-lg-5">
      <div class="card">
        <div class="card-body">
          <h5 class="mb-3">Sipari≈ü √ñzeti</h5>

          <!-- üìÖ Sipari≈ü tarihi -->
          <div class="d-flex justify-content-between mb-2">
            <span class="text-muted">Tarih</span>
            <span>{{ order.created_at|date:"d.m.Y H:i" }}</span>
          </div>

          <!-- üì¶ Sipari≈ü durumu -->
          <div class="d-flex justify-content-between mb-2">
            <span class="text-muted">Durum</span>
            <span class="fw-semibold">
              <span class="fw-semibold">{{ order.get_status_display }}</span>
            </span>
          </div>

          <hr />

          <!-- üí∞ Toplam tutar -->
          <div class="d-flex justify-content-between mb-3">
            <span class="fw-bold">Toplam</span>
            <span class="fw-bold">{{ order.total|floatformat:2 }} ‚Ç∫</span>
          </div>

          <hr />

          <!-- üöö TESLƒ∞MAT Bƒ∞LGƒ∞LERƒ∞ -->
          <h6 class="fw-bold mt-2">Teslimat</h6>

          <div class="text-muted small">Ad Soyad</div>
          <div class="mb-2">{{ order.full_name }}</div>

          <div class="text-muted small">Telefon</div>
          <div class="mb-2">{{ order.phone }}</div>

          <div class="text-muted small">Adres</div>
          <div>{{ order.address }}</div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
